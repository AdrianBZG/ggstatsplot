<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggpiestats • ggstatsplot</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="ggpiestats">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggstatsplot</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/combine_plots.html">combine_plots</a>
    </li>
    <li>
      <a href="../articles/ggbetweenstats.html">ggbetweenstats</a>
    </li>
    <li>
      <a href="../articles/ggcoefstats.html">ggcoefstats</a>
    </li>
    <li>
      <a href="../articles/ggcorrmat.html">ggcorrmat</a>
    </li>
    <li>
      <a href="../articles/gghistostats.html">gghistostats</a>
    </li>
    <li>
      <a href="../articles/ggpiestats.html">ggpiestats</a>
    </li>
    <li>
      <a href="../articles/ggscatterstats.html">ggscatterstats</a>
    </li>
    <li>
      <a href="../articles/plot_design.html">plot design</a>
    </li>
    <li>
      <a href="../articles/purrr_examples.html">using `ggstatsplot` with `purrr` package</a>
    </li>
    <li>
      <a href="../articles/theme_ggstatsplot.html">ggstatsplot theme</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IndrajeetPatil/ggstatsplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ggpiestats</h1>
                        <h4 class="author">Indrajeet Patil</h4>
            
            <h4 class="date">2018-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IndrajeetPatil/ggstatsplot/blob/master/vignettes/ggpiestats.Rmd"><code>vignettes/ggpiestats.Rmd</code></a></small>
      <div class="hidden name"><code>ggpiestats.Rmd</code></div>

    </div>

    
    
<p>The function <code><a href="../reference/ggpiestats.html">ggstatsplot::ggpiestats</a></code> can be used for quick <strong>data exploration</strong> and/or to prepare <strong>publication-ready pie charts</strong> to summarize the statistical relationship between two categorical variables. We will see examples of how to use this function in this vignette.</p>
<p>To begin with, here are some instances where you would want to use <code>ggpiestats</code>-</p>
<ul>
<li>to see if the frequency distribution of two categorical variables are independent of each other using the contingency table analysis</li>
<li>to check if the proportion of observations at each level of a categorical variable is equal</li>
</ul>
<p><strong>Note before</strong>: The following demo uses the pipe operator (<code>%&gt;%</code>), so in case you are not familiar with this operator, here is a good explanation: <a href="http://r4ds.had.co.nz/pipes.html" class="uri">http://r4ds.had.co.nz/pipes.html</a></p>
<div id="statistical-independence-of-categorical-variables-with-ggpiestats" class="section level2">
<h2 class="hasAnchor">
<a href="#statistical-independence-of-categorical-variables-with-ggpiestats" class="anchor"></a>Statistical independence of categorical variables with <code>ggpiestats</code>
</h2>
<p>To demonstrate how <code>ggpiestats</code> can be used to we will be using the <code>Titanic</code> dataset that is included in the <code>datasets</code> library. Titanic Passenger Survival Data Set provides information “on the fate of passengers on the fatal maiden voyage of the ocean liner <em>Titanic</em>, summarized according to economic status (class), sex, age, and survival.”</p>
<p>Let’s have a look at the structure of this table and also convert it into a tibble while we are at it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(datasets)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># looking at the table</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="dt">x =</span> Titanic)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;  'table' num [1:4, 1:2, 1:2, 1:2] 0 0 35 0 0 0 17 0 118 154 ...</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;  - attr(*, "dimnames")=List of 4</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   ..$ Class   : chr [1:4] "1st" "2nd" "3rd" "Crew"</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;   ..$ Sex     : chr [1:2] "Male" "Female"</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;   ..$ Age     : chr [1:2] "Child" "Adult"</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;   ..$ Survived: chr [1:2] "No" "Yes"</span></a></code></pre></div>
<p>Note that the last column in this dataframe contains count information, which means we will have to modify it to reflect this count structure. This has already been carried out and the final dataset is included in the <code>ggstatsplot</code> package in <code>Titanic_full</code>. This is not necessary as <code>ggpiestats</code> <strong>can</strong> handle table structures as well (see examples below).</p>
<p>Let’s have a look at this dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># looking at the final dataset</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(ggstatsplot<span class="op">::</span>Titanic_full)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; Observations: 2,201</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; $ id       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16...</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; $ Class    &lt;fct&gt; 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd...</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; $ Sex      &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, Male, Male,...</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; $ Age      &lt;fct&gt; Child, Child, Child, Child, Child, Child, Child, Chil...</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; $ Survived &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, N...</span></a></code></pre></div>
<p>First, let’s see if the proportion of people who survived was different between sexes using <code>ggpiestats</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># since effect size confidence intervals are computed using bootstrapping, let's</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># set seed for reproducibility</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggpiestats.html">ggpiestats</a></span>(<span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                        <span class="dt">condition =</span> Sex,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                        <span class="dt">main =</span> Survived) </a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats1-1.png" width="768"></p>
<p>A number of arguments can be modified to change the appearance of this plot:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># for reproducibility</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggpiestats.html">ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,             <span class="co"># dataframe (matrix or table will not be accepted)</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="dt">main =</span> Survived,                              <span class="co"># rows in the contingency table</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="dt">condition =</span> Sex,                              <span class="co"># columns in the contingecy table</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  <span class="dt">title =</span> <span class="st">"Passengar survival by gender"</span>,       <span class="co"># title for the entire plot</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  <span class="dt">caption =</span> <span class="st">"Source: Titanic survival dataset"</span>, <span class="co"># caption for the entire plot</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  <span class="dt">legend.title =</span> <span class="st">"Survived?"</span>,                   <span class="co"># legend title</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  <span class="dt">facet.wrap.name =</span> <span class="st">"Gender"</span>,                   <span class="co"># changing the facet wrap title</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  <span class="dt">facet.proptest =</span> <span class="ot">TRUE</span>,                        <span class="co"># proportion test for each facet</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  <span class="dt">stat.title =</span> <span class="st">"survival x gender: "</span>,           <span class="co"># title for statistical test</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  <span class="dt">k =</span> <span class="dv">2</span>,                                        <span class="co"># no. of decimal places for results</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  <span class="dt">ggtheme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_grey</a></span>(),              <span class="co"># changing plot theme </span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  <span class="dt">package =</span> <span class="st">"yarrr"</span>,                            <span class="co"># package from which color palette is to be taken</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  <span class="dt">palette =</span> <span class="st">"southpark"</span>                         <span class="co"># choosing a different color palette</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21">) <span class="op">+</span><span class="st">                                             </span><span class="co"># further modification with ggplot2 commands</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">plot.subtitle =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/element">element_text</a></span>(</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">    <span class="dt">color =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">    <span class="dt">size =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">    <span class="dt">hjust =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26">  ))</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats2-1.png" width="768"></p>
<p>As seen from this plot, the Pearson’s chi-square test of independence shows that the distribution of survival was different across males and females. Additionally, among both males and females, the proportion of survival was not equally likely (at 50%, i.e.), as shown by significant results (<code>***</code>) from one-sample proportion tests for each facet.</p>
<p>In case the <code>condition</code> argument is not specified, instead of chi-square test of independence, a proportion test will be carried out. For example, let’s see if there were equal proportions of different age groups.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggpiestats.html">ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,                          </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="dt">main =</span> Age,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="dt">package =</span> <span class="st">"wesanderson"</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="dt">palette =</span> <span class="st">"IsleofDogs1"</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">)</a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats3-1.png" width="576"></p>
<p>As this plot shows there were overwhelmingly more number of adults than children on the boat and the proportion test attests to this.</p>
</div>
<div id="grouped-analysis-with-grouped_ggpiestats" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped-analysis-with-grouped_ggpiestats" class="anchor"></a>Grouped analysis with <code>grouped_ggpiestats</code>
</h2>
<p>What if we want to do the same analysis separately for the four different Class on the Titanic (1st, 2nd, 3rd, Crew), i.e. checking how the survival-by-gender interaction changes by the passenger class in which the people were traveling? In that case, we will have to either write a <code>for</code> loop or use <code>purrr</code>, both of which are time consuming and can be a bit of a struggle.</p>
<p><code>ggstatsplot</code> provides a special helper function for such instances: <code>grouped_ggpiestats</code>. This is merely a wrapper function around <code><a href="../reference/combine_plots.html">ggstatsplot::combine_plots</a></code>. It applies <code>ggpiestats</code> across all <strong>levels</strong> of a specified <strong>grouping variable</strong> and then combines list of individual plots into a single plot. Note that the grouping variable can be anything: conditions in a given study, groups in a study sample, different studies, etc.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/grouped_ggpiestats.html">grouped_ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="co"># arguments relevant for ggstatsplot::gghistostats</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dt">grouping.var =</span> Class,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">title.prefix =</span> <span class="st">"Passenger class"</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">stat.title =</span> <span class="st">"survival x gender: "</span>,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="dt">main =</span> Survived,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">condition =</span> Sex,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="co"># arguments relevant for ggstatsplot::combine_plots</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">title.text =</span> <span class="st">"Survival in Titanic disaster by gender for all passenger classes"</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  <span class="dt">caption.text =</span> <span class="st">"Asterisks denote results from proportion tests; ***: p &lt; 0.001, ns: non-significant"</span>,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="dt">nrow =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"(a)"</span>,<span class="st">"(b)"</span>,<span class="st">"(c)"</span>, <span class="st">"(d)"</span>)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Warning: The output from `grouped_` functions are not `ggplot` objects and therefore can't be further modified with `ggplot2` functions.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats4-1.png" width="864"></p>
<p>As seen from this quick exploratory analysis, across all passenger classes, the proportion of survived to non-survived individuals differed across genders: Men were more likely to perish than survive, whereas women were more likely to survive than perish. The only exception was the 3rd Class passengers where women were as likely to survive as to perish.</p>
<p>This will work even if the condition argument is not specified:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/grouped_ggpiestats.html">grouped_ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="dt">main =</span> Age,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="dt">grouping.var =</span> Class,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="dt">title.prefix =</span> <span class="st">"Passenger Class"</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="dt">package =</span> <span class="st">"ggsci"</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="dt">palette =</span> <span class="st">"category10_d3"</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="dt">direction =</span> <span class="dv">-1</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">) </a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; Warning: The output from `grouped_` functions are not `ggplot` objects and therefore can't be further modified with `ggplot2` functions.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats5-1.png" width="960"></p>
</div>
<div id="grouped-analysis-with-ggpiestats-purrr" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped-analysis-with-ggpiestats-purrr" class="anchor"></a>Grouped analysis with <code>ggpiestats</code> + <code>purrr</code>
</h2>
<p>Although this grouping function provides a quick way to explore the data, it leaves much to be desired. For example, we may want to add different captions, titles, themes, or palettes for each level of the grouping variable, etc. For cases like these, it would be better to use <code>purrr</code> package. See the associated vignette here: <a href="https://indrajeetpatil.github.io/ggstatsplot/articles/purrr_examples.html" class="uri">https://indrajeetpatil.github.io/ggstatsplot/articles/purrr_examples.html</a></p>
</div>
<div id="working-with-counts-data" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-counts-data" class="anchor"></a>Working with <code>counts</code> data</h2>
<p><code>ggpiestats</code> can also work with dataframe containing counts (aka tabled data), i.e., when each row doesn’t correspond to a unique observation. For example, consider the following <code>fishing</code> dataframe containing data from two boats (<code>A</code> and <code>B</code>) about the number of different types fish they caught in the months of <code>February</code> and <code>March</code>. In this dataframe, each row doesn’t equal a unique observation. In such cases, we can use <code>counts</code> argument. Let’s say we want to investigate if the frequency of different types of fish caught differs across the two months:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># for reproducibility</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># creating a dataframe</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># (this is completely fictional; I don't know first thing about fishing!)</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">(</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  fishing &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">    <span class="dt">Boat =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"B"</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">"A"</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">"A"</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">"B"</span>, <span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">    <span class="dt">Month =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"February"</span>, <span class="dv">2</span>), <span class="kw">rep</span>(<span class="st">"March"</span>, <span class="dv">2</span>), <span class="kw">rep</span>(<span class="st">"February"</span>, <span class="dv">2</span>), <span class="kw">rep</span>(<span class="st">"March"</span>, <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">    <span class="dt">Fish =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">      <span class="st">"Bass"</span>,</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">      <span class="st">"Catfish"</span>,</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">      <span class="st">"Cod"</span>,</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">      <span class="st">"Haddock"</span>,</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">      <span class="st">"Cod"</span>,</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">      <span class="st">"Haddock"</span>,</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">      <span class="st">"Bass"</span>,</a>
<a class="sourceLine" id="cb8-18" data-line-number="18">      <span class="st">"Catfish"</span>,</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">      <span class="st">"Bass"</span>,</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">      <span class="st">"Catfish"</span>,</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">      <span class="st">"Cod"</span>,</a>
<a class="sourceLine" id="cb8-22" data-line-number="22">      <span class="st">"Haddock"</span>,</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">      <span class="st">"Cod"</span>,</a>
<a class="sourceLine" id="cb8-24" data-line-number="24">      <span class="st">"Haddock"</span>,</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">      <span class="st">"Bass"</span>,</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">      <span class="st">"Catfish"</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27">    ),</a>
<a class="sourceLine" id="cb8-28" data-line-number="28">    <span class="dt">SumOfCaught =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">42</span>, <span class="dv">40</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="dv">26</span>, <span class="dv">100</span>, <span class="dv">30</span>, <span class="dv">20</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># converting to a tibble dataframe</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="st">    </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .)</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">)</a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; # A tibble: 16 x 4</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt;    Boat  Month    Fish    SumOfCaught</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt;  1 B     February Bass             25</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt;  2 B     February Catfish          20</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt;  3 B     March    Cod              35</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt;  4 B     March    Haddock          40</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt;  5 A     February Cod              40</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt;  6 A     February Haddock          25</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt;  7 A     March    Bass             30</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt;  8 A     March    Catfish          42</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt;  9 A     February Bass             40</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; 10 A     February Catfish          30</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; 11 A     March    Cod              33</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; 12 A     March    Haddock          26</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt; 13 B     February Cod             100</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt; 14 B     February Haddock          30</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt; 15 B     March    Bass             20</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt; 16 B     March    Catfish          20</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co"># running `ggpiestats` with counts information</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggpiestats.html">ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb8-54" data-line-number="54">  <span class="dt">data =</span> fishing,</a>
<a class="sourceLine" id="cb8-55" data-line-number="55">  <span class="dt">main =</span> Fish,</a>
<a class="sourceLine" id="cb8-56" data-line-number="56">  <span class="dt">condition =</span> Month,</a>
<a class="sourceLine" id="cb8-57" data-line-number="57">  <span class="dt">counts =</span> SumOfCaught,</a>
<a class="sourceLine" id="cb8-58" data-line-number="58">  <span class="dt">package =</span> <span class="st">"ggsci"</span>,</a>
<a class="sourceLine" id="cb8-59" data-line-number="59">  <span class="dt">palette =</span> <span class="st">"default_jama"</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60">)</a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats7-1.png" width="864"></p>
<p>We just verified that the frequency of different types of fish caught differs across the two months, but what if we further want to know if this difference is present for both boats (since they are fishing in different parts of the sea)? For this, we can again utilize <code>grouped_ggpiestats</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># running the grouped variant of the function</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/grouped_ggpiestats.html">grouped_ggpiestats</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">data =</span> fishing,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">main =</span> Fish,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">condition =</span> Month,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  <span class="dt">counts =</span> SumOfCaught,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">  <span class="dt">grouping.var =</span> Boat,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">  <span class="dt">title.prefix =</span> <span class="st">"Boat"</span>,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  <span class="dt">nrow =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Note: 95% CI for Cramer's V was computed with  25 bootstrap samples.Warning: The output from `grouped_` functions are not `ggplot` objects and therefore can't be further modified with `ggplot2` functions.</span></a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats8-1.png" width="768"></p>
<p>As seen from these charts, this difference is found only for the location in which the boat <code>B</code> has been fishing. Additionally, faceted proportion tests also reveal that all fish are not equally likely to be caught at this location.</p>
</div>
<div id="within-subjects-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#within-subjects-designs" class="anchor"></a>Within-subjects designs</h2>
<p>In case of within-subjects designs, you can set <code>paired = TRUE</code>, which will display results from McNemar test in the subtitle.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># seed for reproducibility</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># data</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">clinical_trial &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/tribble">tribble</a></span>(</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    <span class="op">~</span>Control,   <span class="op">~</span>Case,  <span class="op">~</span>pairs,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    <span class="st">"No"</span>,   <span class="st">"Yes"</span>,  <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    <span class="st">"Yes"</span>,  <span class="st">"No"</span>,   <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">    <span class="st">"Yes"</span>,  <span class="st">"Yes"</span>,  <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">    <span class="st">"No"</span>,   <span class="st">"No"</span>,   <span class="dv">92</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggpiestats.html">ggpiestats</a></span>(<span class="dt">data =</span> clinical_trial,</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">                        <span class="dt">condition =</span> Control,</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">                        <span class="dt">main =</span> Case,</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">                        <span class="dt">counts =</span> pairs,</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">                        <span class="dt">paired =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">                        <span class="dt">stat.title =</span> <span class="st">"McNemar test: "</span>,</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">                        <span class="dt">title =</span> <span class="st">"Results from case-control study"</span>,</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">                        <span class="dt">package =</span> <span class="st">"ggsci"</span>,</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">                        <span class="dt">palette =</span> <span class="st">"default_ucscgb"</span>,</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">                        <span class="dt">direction =</span> <span class="dv">-1</span>) </a></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats9-1.png" width="768"></p>
</div>
<div id="suggestions" class="section level1">
<h1 class="hasAnchor">
<a href="#suggestions" class="anchor"></a>Suggestions</h1>
<p>If you find any bugs or have any suggestions/remarks, please file an issue on GitHub: <a href="https://github.com/IndrajeetPatil/ggstatsplot/issues" class="uri">https://github.com/IndrajeetPatil/ggstatsplot/issues</a></p>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h1>
<p>Summarizing session information for reproducibility.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">width =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/session_info">session_info</a></span>()</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#statistical-independence-of-categorical-variables-with-ggpiestats">Statistical independence of categorical variables with <code>ggpiestats</code></a></li>
      <li><a href="#grouped-analysis-with-grouped_ggpiestats">Grouped analysis with <code>grouped_ggpiestats</code></a></li>
      <li><a href="#grouped-analysis-with-ggpiestats-purrr">Grouped analysis with <code>ggpiestats</code> + <code>purrr</code></a></li>
      <li><a href="#working-with-counts-data">Working with <code>counts</code> data</a></li>
      <li><a href="#within-subjects-designs">Within-subjects designs</a></li>
      <li><a href="#suggestions">Suggestions</a></li>
      <li><a href="#session-information">Session Information</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/indrajeetspatilmorality/">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: '44345fbe359c5496fbc3955c513333d1',
    indexName: 'ggstatsplot',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
