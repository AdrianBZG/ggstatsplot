<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggcoefstats • ggstatsplot</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="ggcoefstats">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggstatsplot</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.0.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/combine_plots.html">combine_plots</a>
    </li>
    <li>
      <a href="../articles/ggbetweenstats.html">ggbetweenstats</a>
    </li>
    <li>
      <a href="../articles/ggcoefstats.html">ggcoefstats</a>
    </li>
    <li>
      <a href="../articles/ggcorrmat.html">ggcorrmat</a>
    </li>
    <li>
      <a href="../articles/gghistostats.html">gghistostats</a>
    </li>
    <li>
      <a href="../articles/ggpiestats.html">ggpiestats</a>
    </li>
    <li>
      <a href="../articles/ggscatterstats.html">ggscatterstats</a>
    </li>
    <li>
      <a href="../articles/plot_design.html">plot design</a>
    </li>
    <li>
      <a href="../articles/theme_ggstatsplot.html">ggstatsplot theme</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IndrajeetPatil/ggstatsplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ggcoefstats</h1>
                        <h4 class="author">Indrajeet Patil</h4>
            
            <h4 class="date">2018-09-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IndrajeetPatil/ggstatsplot/blob/master/vignettes/ggcoefstats.Rmd"><code>vignettes/ggcoefstats.Rmd</code></a></small>
      <div class="hidden name"><code>ggcoefstats.Rmd</code></div>

    </div>

    
    
<p>The function <code><a href="../reference/ggcoefstats.html">ggstatsplot::ggcoefstats</a></code> generates <strong>dot-and-whisker plots</strong> of regression models saved in tidy data frames (produced with the <code>broom</code> package). By default, the plot displays <code>95%</code> confidence intervals for the regression coefficients. The function currently supports only those classes of object that are supported by the <code>broom</code> package. For an exhaustive list, see- <a href="https://broom.tidyverse.org/articles/available-methods.html" class="uri">https://broom.tidyverse.org/articles/available-methods.html</a></p>
<p>In this vignette, we will see examples of how to use this function. We will try to cover as many classes of objects as possible. Unfortunately, there is no single dataset that will be helpful for carrying out all types of regression analyses and, therefore, we will use various datasets to explore data-specific hypotheses using regression models.</p>
<p><strong>Note before</strong>: The following demo uses the pipe operator (<code>%&gt;%</code>), so in case you are not familiar with this operator, here is a good explanation: <a href="http://r4ds.had.co.nz/pipes.html" class="uri">http://r4ds.had.co.nz/pipes.html</a></p>
<div id="general-structure-of-the-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#general-structure-of-the-plots" class="anchor"></a>General structure of the plots</h2>
<p>Although the statistical models displayed in the plot may differ based on the class of models being investigated, there are few aspects of the plot that will be invariant across models:</p>
<ul>
<li>The dot-whisker plot contains a dot representing the <strong>estimate</strong> and their <strong>confidence intervals</strong> (<code>95%</code> is the default). The estimate can either be effect sizes (for tests that depend on the <code>F</code> statistic) or regression coefficients (for tests with <code>t</code> and <code>z</code> statistic), etc. The function will, by default, display a helpful x-axis label that should clear up what estimates are being displayed. The confidence intervals can sometimes be asymmetric if bootstrapping was used.</li>
<li>The caption will always contain diagnostic information, if available, about models that can be useful for model selection: The smaller the Akaike’s Information Criterion (<strong>AIC</strong>) and the Bayesian Information Criterion (<strong>BIC</strong>) values, the “better” the model is. Additionally, the higher the <strong>log-likelihood</strong> value the “better” is the model fit.</li>
<li>The output of this function will be a <code>ggplot2</code> object and, thus, it can be further modified (e.g., change themes, etc.) with <code>ggplot2</code> functions.</li>
</ul>
<p>In the following examples, we will try out a number of regression models and, additionally, we will also see how we can change different aspects of the plot itself.</p>
</div>
<div id="omnibus-anova-aov" class="section level2">
<h2 class="hasAnchor">
<a href="#omnibus-anova-aov" class="anchor"></a>omnibus ANOVA (<code>aov</code>)</h2>
<p>For this analysis, let’s use the <code>movies_long</code> dataset, which provides information about IMDB ratings, budget, length, MPAA ratings (e.g., R-rated, NC-17, PG-13, etc.), and genre for a number of movies. Let’s say our hypothesis is that the IMDB ratings for a movie are predicted by a multiplicative effect of the genre and the MPAA rating it got. To begin with, let’s carry out an omnibus ANOVA to see if this is the case.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># for reproducibility</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># looking at the data</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="dt">x =</span> ggstatsplot<span class="op">::</span>movies_long)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Observations: 2,433</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; Variables: 8</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; $ title  &lt;fct&gt; Shawshank Redemption, The, Lord of the Rings: The Retur...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; $ year   &lt;int&gt; 1994, 2003, 2001, 2002, 1994, 1993, 1977, 1980, 1968, 2...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; $ length &lt;int&gt; 142, 251, 208, 223, 168, 195, 125, 129, 158, 135, 93, 1...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; $ budget &lt;dbl&gt; 25.0, 94.0, 93.0, 94.0, 8.0, 25.0, 11.0, 18.0, 5.0, 3.3...</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; $ rating &lt;dbl&gt; 9.1, 9.0, 8.8, 8.8, 8.8, 8.8, 8.8, 8.8, 8.7, 8.7, 8.7, ...</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; $ votes  &lt;int&gt; 149494, 103631, 157608, 114797, 132745, 97667, 134640, ...</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; $ mpaa   &lt;fct&gt; R, PG-13, PG-13, PG-13, R, R, PG, PG, PG-13, R, PG, R, ...</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; $ genre  &lt;fct&gt; Drama, Action, Action, Action, Drama, Drama, Action, Ac...</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">*</span><span class="st"> </span>genre,</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">    <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  ),</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">  <span class="dt">effsize =</span> <span class="st">"omega"</span>,                        <span class="co"># changing the effect size estimate being displayed</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24">  <span class="dt">point.color =</span> <span class="st">"red"</span>,                      <span class="co"># changing the point color</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  <span class="dt">point.size =</span> <span class="dv">4</span>,                           <span class="co"># changing the point size</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">  <span class="dt">point.shape =</span> <span class="dv">15</span>,                         <span class="co"># changing the point shape</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">  <span class="dt">title =</span> <span class="st">"omnibus ANOVA"</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28">) <span class="op">+</span><span class="st">                                    </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="st">  </span><span class="co"># further modification with the ggplot2 commands</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="st">  </span><span class="co"># note the order in which the labels are entered</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_discrete">scale_y_discrete</a></span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"MPAA"</span>, <span class="st">"Genre"</span>, <span class="st">"Interaction term"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"effect size estimate (partial omega-squared)"</span>,</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">                <span class="dt">y =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aov-1.png" width="768"></p>
<p>As this plot shows, there is no interaction effect between these two factors.</p>
<p>Note that we can also use this function for model selection. Let’s try out different models and see how the AIC, BIC, and log-likelihood values change.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># for reproducibility</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="co"># model 1</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(<span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa,</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">                   <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long),</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">    <span class="dt">title =</span> <span class="st">"1. Only MPAA ratings"</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  ),</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(<span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>genre,</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">                   <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long),</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    <span class="dt">title =</span> <span class="st">"2. Only genre"</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">  ),</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(<span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">+</span><span class="st"> </span>genre,</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">                   <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long),</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    <span class="dt">title =</span> <span class="st">"3. Additive effect of MPAA and genre"</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">  ),</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(<span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">*</span><span class="st"> </span>genre,</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">                   <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long),</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">    <span class="dt">title =</span> <span class="st">"4. Multiplicative effect of MPAA and genre"</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28">  ),</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">  <span class="dt">title.text =</span> <span class="st">"Model selection using ggcoefstats"</span>,</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span>, <span class="st">"(d)"</span>)</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aov2-1.png" width="960"></p>
<p>Looking at the model diagnostics, we can see that the model with only <code>genre</code> as the predictor of ratings seems to perform almost equally well as more complicated additive and multiplicative models. Although there is certainly some improvement with additive and multiplicative models, it is by no means convincing enough (e.g., AIC improves by a mere <code>0.09%</code>) for us to abandon a simpler model. This insight can also be garnered by just looking at the effect sizes, which also tell us that which genre the movie belongs to seems to account for the largest variance.</p>
</div>
<div id="linear-model-lm" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-model-lm" class="anchor"></a>linear model (<code>lm</code>)</h2>
<p>Now that we have figured out that the movie <code>genre</code> best explains a fair deal of variation in how good people rate the movie to be on IMDB. Let’s run a linear regression model to see how different types of genres compare with each other-</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># let's check all the levels for the genre variable</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">levels</span>(ggstatsplot<span class="op">::</span>movies_long<span class="op">$</span>genre)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [1] "Action"      "Animation"   "Comedy"      "Documentary" "Drama"      </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; [6] "Romance"</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>genre,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  ),</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,                      <span class="co"># changing the confidence levels for confidence intervals</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  <span class="dt">sort =</span> <span class="st">"ascending"</span>,                     <span class="co"># sorting the terms of the model based on estimate values</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  <span class="dt">label.direction =</span> <span class="st">"both"</span>,               <span class="co"># direction in which to adjust position of labels (both x and y)</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  <span class="dt">ggtheme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_gray</a></span>(),        <span class="co"># changing the default theme</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="dt">stats.label.color =</span> <span class="kw">c</span>(<span class="st">"#CC79A7"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#0072B2"</span>, <span class="st">"black"</span>, <span class="st">"red"</span>),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  <span class="dt">title =</span> <span class="st">"Movie ratings by their genre"</span>,</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  <span class="dt">subtitle =</span> <span class="st">"Source: www.imdb.com"</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">) <span class="op">+</span><span class="st">                                    </span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="st">  </span><span class="co"># further modification with the ggplot2 commands</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="st">  </span><span class="co"># note the order in which the labels are entered</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_discrete">scale_y_discrete</a></span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Comedy"</span>, <span class="st">"Romance"</span>, <span class="st">"Documentary"</span>, <span class="st">"Animation"</span>, <span class="st">"Drama"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">y =</span> <span class="st">"genre (comparison level: Action)"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">axis.title.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/element">element_text</a></span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">"bold"</span>))</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lm-1.png" width="768"></p>
<p>As can be seen from the regression coefficients, compared to the action movies, only romantic movies, animated movies, and dramas fare better with the audiences.</p>
<!-- 
## robust linear model (`rlm`)

A linear model by robust regression using an M estimator, as implemented in `MASS::rlm` is also supported.


```r
ggstatsplot::ggcoefstats(
  x = MASS::rlm(
    formula = rating ~ genre,
    data = ggstatsplot::movies_long
  ),
  conf.level = 0.99,                      # changing the confidence levels for confidence intervals
  sort = "ascending",                     # sorting the terms of the model based on estimate values
  label.direction = "both",               # direction in which to adjust position of labels (both x and y)
  ggtheme = ggplot2::theme_gray(),        # changing the default theme
  stats.label.color = c("#CC79A7", "darkgreen", "#0072B2", "black", "red"),
  title = "Movie ratings by their genre",
  subtitle = "Source: www.imdb.com"
) +                                    
  ggplot2::scale_y_discrete(labels = c("Comedy", "Romance", "Documentary", "Animation", "Drama")) +
  ggplot2::labs(y = "genre (comparison level: Action)") + 
  ggplot2::theme(axis.title.y = ggplot2::element_text(size = 14, face = "bold"))
```

<img src="ggcoefstats_files/figure-html/rlm-1.png" width="768" />
-->
</div>
<div id="linear-mixed-effects-model-lmer" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-mixed-effects-model-lmer" class="anchor"></a>linear mixed-effects model (<code>lmer</code>)</h2>
<p>Now let’s say we want to see how movie’s budget relates to how good the movie is rated to be on IMDB (e.g., more money, better ratings?). But we have reasons to believe that the relationship between these two variables might be different for different genres (e.g., budget might be a good predictor of how good the movie is rated to be for animations or actions movies as more money can help with better visual effects and animations, but this may not be true for dramas; also see the <a href="https://indrajeetpatil.github.io/ggstatsplot/articles/ggscatterstats.html"><code>ggscatterstats</code></a> vignette), so we don’t want to use <code><a href="http://www.rdocumentation.org/packages/stats/topics/lm">stats::lm</a></code>. In this case, therefore, we will be running a linear mixed-effects model (using <code><a href="http://www.rdocumentation.org/packages/lme4/topics/lmer">lme4::lmer</a></code> and p-values generated using the <code>sjstats::p_values</code> function) with a random slope for the genre variable.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># combining the two different plots</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="co"># model 1: simple linear model</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">      <span class="dt">formula =</span> <span class="kw">scale</span>(rating) <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(budget),</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">      <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">    ),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="dt">title =</span> <span class="st">"linear model"</span>,</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>                       <span class="co"># show the intercept</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="st">"'standardized regression coefficient' ~italic(beta)"</span>)),</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  <span class="co"># model 2: linear mixed-effects model</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">    <span class="dt">x =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/lmer">lmer</a></span>(</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>budget <span class="op">+</span><span class="st"> </span>(budget <span class="op">|</span><span class="st"> </span>genre),</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">      <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long,</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">      <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/lmerControl">lmerControl</a></span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">    ),</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">    <span class="dt">p.kr =</span> <span class="ot">TRUE</span>,                                    <span class="co"># use Kenward-Roger approximation to compute p-values (fast)</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">    <span class="dt">title =</span> <span class="st">"linear mixed-effects model"</span>,</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>                       <span class="co"># show the intercept</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="st">"'standardized regression coefficient' ~italic(beta)"</span>), </a>
<a class="sourceLine" id="cb4-28" data-line-number="28">                  <span class="dt">y =</span> <span class="st">"fixed effects"</span>),</a>
<a class="sourceLine" id="cb4-29" data-line-number="29">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>),</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">  <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">  <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-32" data-line-number="32">  <span class="dt">title.text =</span> <span class="st">"Relationship between movie budget and its IMDB rating"</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33">)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lmer-1.png" width="672"></p>
<p>As can be seen from these plots, although there seems to be a really small correlation between budget and rating in a linear model, this effect is not significant once we take into account the hierarchical structure of the data.</p>
<p>Note that for mixed-effects models, only the fixed effects are shown as there are no confidence intervals for random effects terms to show with whiskers in a dot-and-whisker plots. In case, you would like to see these terms, you can enter the same object you entered as <code>x</code> argument to <code>ggcoefstats</code> in <code><a href="http://www.rdocumentation.org/packages/broom/topics/reexports">broom::tidy</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">broom<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/reexports">tidy</a></span>(</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="dt">x =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/lmer">lmer</a></span>(</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>budget <span class="op">+</span><span class="st"> </span>(budget <span class="op">|</span><span class="st"> </span>genre),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/lmerControl">lmerControl</a></span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  ),</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="dt">conf.level =</span> <span class="fl">0.95</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; # A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;   term             estimate std.error statistic  conf.low conf.high group </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 1 (Intercept)       5.94      0.166       35.7    5.61e+0   6.26    fixed </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 2 budget            0.00286   0.00174      1.64  -5.53e-4   0.00627 fixed </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 3 sd_(Intercept).~  0.377    NA           NA     NA        NA       genre </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 4 sd_budget.genre   0.00336  NA           NA     NA        NA       genre </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; 5 cor_(Intercept)~ -0.631    NA           NA     NA        NA       genre </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 6 sd_Observation.~  1.16     NA           NA     NA        NA       Resid~</span></a></code></pre></div>
</div>
<div id="non-linear-least-squares-model-nls" class="section level2">
<h2 class="hasAnchor">
<a href="#non-linear-least-squares-model-nls" class="anchor"></a>Non-linear least-squares model (<code>nls</code>)</h2>
<p>So far we have been assuming a linear relationship between movie budget and rating. But what if we want to also explore the possibility of a non-linear relationship? In that case, we can run a non-linear least squares regression. Note that you need to choose some non-linear function, which will be based on prior exploratory data analysis (<code>y ~ k/x + c</code> implemented here, but you can try out other non-linear functions, e.g. <code>Y ~ k * exp(-b*c)</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/nls">nls</a></span>(</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>budget <span class="op">+</span><span class="st"> </span>c,                <span class="co"># try toying around with the form of non-linear function</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">      <span class="dt">data =</span> ggstatsplot<span class="op">::</span>movies_long,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">      <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">    ),</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="dt">title =</span> <span class="st">"Non-linear relationship between budget and rating"</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="dt">subtitle =</span> <span class="st">"Source: IMDB"</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  )</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nls-1.png" width="576"></p>
<p>This analysis shows that there is indeed a possible non-linear association between rating and budget (non-linear regression term <code>k</code> is significant), at least with the particular non-linear function we used.</p>
</div>
<div id="generalized-linear-model-glm" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-model-glm" class="anchor"></a>generalized linear model (<code>glm</code>)</h2>
<p>In all the analyses carried out thus far, the outcome variable (<code>y</code> in <code>y ~ x</code>) has been continuous. In case the outcome variable is nominal/categorical/factor, we can use the <strong>generalized</strong> form of linear model that works even if the response is a numeric vector or a factor vector, etc.</p>
<p>To explore this model, we will use the Titanic dataset, which tabulates information on the fate of passengers on the fatal maiden voyage of the ocean liner <em>Titanic</em>, summarized according to economic status (class), sex, age, and survival. Let’s say we want to know what was the strongest predictor of whether someone survived the Titanic disaster-</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># having a look at the Titanic dataset</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="dt">x =</span> Titanic)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">str</span>(df)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; 'data.frame':    32 obs. of  5 variables:</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  $ Class   : Factor w/ 4 levels "1st","2nd","3rd",..: 1 2 3 4 1 2 3 4 1 2 ...</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  $ Sex     : Factor w/ 2 levels "Male","Female": 1 1 1 1 2 2 2 2 1 1 ...</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  $ Age     : Factor w/ 2 levels "Child","Adult": 1 1 1 1 1 1 1 1 2 2 ...</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  $ Survived: Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  $ Freq    : num  0 0 35 0 0 0 17 0 118 154 ...</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">    <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age,</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">    <span class="dt">data =</span> df,</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">    <span class="dt">weights =</span> df<span class="op">$</span>Freq,                          <span class="co"># vector containing weights (no. of observations per row)</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19">    <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>)    <span class="co"># choosing the family</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">  ),</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">  <span class="dt">ggtheme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_dark</a></span>(),</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">  <span class="dt">vline.color =</span> <span class="st">"red"</span>,</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">  <span class="dt">vline.linetype =</span> <span class="st">"solid"</span>,</a>
<a class="sourceLine" id="cb7-25" data-line-number="25">  <span class="dt">label.segment.color =</span> <span class="st">"red"</span>,</a>
<a class="sourceLine" id="cb7-26" data-line-number="26">  <span class="dt">stats.label.size =</span> <span class="fl">3.5</span>,</a>
<a class="sourceLine" id="cb7-27" data-line-number="27">  <span class="dt">stats.label.color =</span> <span class="kw">c</span>(<span class="st">"orangered"</span>,</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">                        <span class="st">"dodgerblue"</span>)</a>
<a class="sourceLine" id="cb7-29" data-line-number="29">) </a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glm-1.png" width="576"></p>
<p>As can be seen from the regression coefficients, all entered predictors were significant predictors of the outcome. More specifically, being a female was associated with higher likelihood of survival (compared to male). On other hand, being an adult was associated with decreased likelihood of survival (compared to child).</p>
<p>Note that the exact statistic will depend on the family used. Below we will see a host of different function calls to <code>glm</code> with a variety of different families. Note that some families have a <code>t</code> statistic associated with them, while others a <code>z</code> statistic. The function will figure this out for you in the background.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># creating dataframes to use for regression analyses</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># dataframe #1</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">(</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  df.counts &lt;-</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="st">    </span>base<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">      <span class="dt">treatment =</span> <span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">length =</span> <span class="dv">9</span>),</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">      <span class="dt">outcome =</span> <span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">9</span>),</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">      <span class="dt">counts =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">13</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">    ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">    </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .)</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; # A tibble: 9 x 3</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;   treatment outcome counts</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; 1 1         1           18</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; 2 1         2           17</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; 3 1         3           15</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; 4 2         1           20</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; 5 2         2           10</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; 6 2         3           20</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; 7 3         1           25</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; 8 3         2           13</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; 9 3         3           12</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co"># dataframe #2</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28">(df.clotting &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">  <span class="dt">u =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb8-30" data-line-number="30">  <span class="dt">lot1 =</span> <span class="kw">c</span>(<span class="dv">118</span>, <span class="dv">58</span>, <span class="dv">42</span>, <span class="dv">35</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">  <span class="dt">lot2 =</span> <span class="kw">c</span>(<span class="dv">69</span>, <span class="dv">35</span>, <span class="dv">26</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .))</a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; # A tibble: 9 x 3</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt;       u  lot1  lot2</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; 1     5   118    69</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; 2    10    58    35</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; 3    15    42    26</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; 4    20    35    21</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; 5    30    27    18</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; 6    40    25    16</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; 7    60    21    13</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; 8    80    19    12</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; 9   100    18    12</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co"># dataframe #3</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48">x1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb8-49" data-line-number="49">y1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">lambda =</span> <span class="kw">exp</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1))</a>
<a class="sourceLine" id="cb8-50" data-line-number="50">(df<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="st">    </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .))</a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt; # A tibble: 100 x 2</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;          x     y</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt;      &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt;  1  1.56      12</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt;  2  0.0705     2</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt;  3  0.129      2</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt;  4  1.72      11</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt;  5  0.461      3</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt;  6 -1.27       0</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt;  7 -0.687      2</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt;  8 -0.446      0</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt;  9  1.22      11</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; 10  0.360      3</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; # ... with 90 more rows</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co"># dataframe #4</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68">x2 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb8-69" data-line-number="69">y2 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb8-70" data-line-number="70">             <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb8-71" data-line-number="71">             <span class="dt">prob =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(x2))</a>
<a class="sourceLine" id="cb8-72" data-line-number="72"></a>
<a class="sourceLine" id="cb8-73" data-line-number="73">(df<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x2, <span class="dt">y =</span> y2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-74" data-line-number="74"><span class="st">    </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .))</a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="co">#&gt; # A tibble: 100 x 2</span></a>
<a class="sourceLine" id="cb8-76" data-line-number="76"><span class="co">#&gt;         x     y</span></a>
<a class="sourceLine" id="cb8-77" data-line-number="77"><span class="co">#&gt;     &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-78" data-line-number="78"><span class="co">#&gt;  1  1.05      1</span></a>
<a class="sourceLine" id="cb8-79" data-line-number="79"><span class="co">#&gt;  2 -1.05      0</span></a>
<a class="sourceLine" id="cb8-80" data-line-number="80"><span class="co">#&gt;  3 -1.26      0</span></a>
<a class="sourceLine" id="cb8-81" data-line-number="81"><span class="co">#&gt;  4  3.24      1</span></a>
<a class="sourceLine" id="cb8-82" data-line-number="82"><span class="co">#&gt;  5 -0.417     0</span></a>
<a class="sourceLine" id="cb8-83" data-line-number="83"><span class="co">#&gt;  6  0.298     0</span></a>
<a class="sourceLine" id="cb8-84" data-line-number="84"><span class="co">#&gt;  7  0.637     0</span></a>
<a class="sourceLine" id="cb8-85" data-line-number="85"><span class="co">#&gt;  8 -0.484     0</span></a>
<a class="sourceLine" id="cb8-86" data-line-number="86"><span class="co">#&gt;  9  0.517     0</span></a>
<a class="sourceLine" id="cb8-87" data-line-number="87"><span class="co">#&gt; 10  0.369     1</span></a>
<a class="sourceLine" id="cb8-88" data-line-number="88"><span class="co">#&gt; # ... with 90 more rows</span></a>
<a class="sourceLine" id="cb8-89" data-line-number="89"></a>
<a class="sourceLine" id="cb8-90" data-line-number="90"><span class="co"># combining all plots in a single plot</span></a>
<a class="sourceLine" id="cb8-91" data-line-number="91">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</a>
<a class="sourceLine" id="cb8-92" data-line-number="92">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-93" data-line-number="93">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-94" data-line-number="94">      <span class="dt">formula =</span> counts <span class="op">~</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>treatment,</a>
<a class="sourceLine" id="cb8-95" data-line-number="95">      <span class="dt">data =</span> df.counts,</a>
<a class="sourceLine" id="cb8-96" data-line-number="96">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">poisson</a></span>(<span class="dt">link =</span> <span class="st">"log"</span>)</a>
<a class="sourceLine" id="cb8-97" data-line-number="97">    ),</a>
<a class="sourceLine" id="cb8-98" data-line-number="98">    <span class="dt">title =</span> <span class="st">"Family: Poisson"</span></a>
<a class="sourceLine" id="cb8-99" data-line-number="99">  ),</a>
<a class="sourceLine" id="cb8-100" data-line-number="100">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-101" data-line-number="101">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-102" data-line-number="102">      <span class="dt">formula =</span> lot1 <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(u),</a>
<a class="sourceLine" id="cb8-103" data-line-number="103">      <span class="dt">data =</span> df.clotting,</a>
<a class="sourceLine" id="cb8-104" data-line-number="104">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">Gamma</a></span>(<span class="dt">link =</span> <span class="st">"inverse"</span>)</a>
<a class="sourceLine" id="cb8-105" data-line-number="105">    ),</a>
<a class="sourceLine" id="cb8-106" data-line-number="106">    <span class="dt">title =</span> <span class="st">"Family: Gamma"</span></a>
<a class="sourceLine" id="cb8-107" data-line-number="107">  ),</a>
<a class="sourceLine" id="cb8-108" data-line-number="108">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-109" data-line-number="109">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-110" data-line-number="110">      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb8-111" data-line-number="111">      <span class="dt">family =</span> <span class="kw">quasi</span>(<span class="dt">variance =</span> <span class="st">"mu"</span>, <span class="dt">link =</span> <span class="st">"log"</span>),</a>
<a class="sourceLine" id="cb8-112" data-line-number="112">      <span class="dt">data =</span> df<span class="fl">.3</span></a>
<a class="sourceLine" id="cb8-113" data-line-number="113">    ),</a>
<a class="sourceLine" id="cb8-114" data-line-number="114">    <span class="dt">title =</span> <span class="st">"Family: Quasi"</span></a>
<a class="sourceLine" id="cb8-115" data-line-number="115">  ),</a>
<a class="sourceLine" id="cb8-116" data-line-number="116">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-117" data-line-number="117">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-118" data-line-number="118">      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb8-119" data-line-number="119">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">quasibinomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</a>
<a class="sourceLine" id="cb8-120" data-line-number="120">      <span class="dt">data =</span> df<span class="fl">.4</span></a>
<a class="sourceLine" id="cb8-121" data-line-number="121">    ),</a>
<a class="sourceLine" id="cb8-122" data-line-number="122">    <span class="dt">title =</span> <span class="st">"Family: Quasibinomial"</span></a>
<a class="sourceLine" id="cb8-123" data-line-number="123">  ),</a>
<a class="sourceLine" id="cb8-124" data-line-number="124">    ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-125" data-line-number="125">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-126" data-line-number="126">      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb8-127" data-line-number="127">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">quasipoisson</a></span>(<span class="dt">link =</span> <span class="st">"log"</span>),</a>
<a class="sourceLine" id="cb8-128" data-line-number="128">      <span class="dt">data =</span> df<span class="fl">.4</span></a>
<a class="sourceLine" id="cb8-129" data-line-number="129">    ),</a>
<a class="sourceLine" id="cb8-130" data-line-number="130">    <span class="dt">title =</span> <span class="st">"Family: Quasipoisson"</span></a>
<a class="sourceLine" id="cb8-131" data-line-number="131">  ),</a>
<a class="sourceLine" id="cb8-132" data-line-number="132">    ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb8-133" data-line-number="133">    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(</a>
<a class="sourceLine" id="cb8-134" data-line-number="134">      <span class="dt">formula =</span> Sepal.Length <span class="op">~</span><span class="st"> </span>Species,</a>
<a class="sourceLine" id="cb8-135" data-line-number="135">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">gaussian</a></span>(<span class="dt">link =</span> <span class="st">"identity"</span>),</a>
<a class="sourceLine" id="cb8-136" data-line-number="136">      <span class="dt">data =</span> iris</a>
<a class="sourceLine" id="cb8-137" data-line-number="137">    ),</a>
<a class="sourceLine" id="cb8-138" data-line-number="138">    <span class="dt">title =</span> <span class="st">"Family: Gaussian"</span></a>
<a class="sourceLine" id="cb8-139" data-line-number="139">  ),</a>
<a class="sourceLine" id="cb8-140" data-line-number="140">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span>, <span class="st">"(d)"</span>, <span class="st">"(e)"</span>, <span class="st">"(f)"</span>),</a>
<a class="sourceLine" id="cb8-141" data-line-number="141">  <span class="dt">ncol =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb8-142" data-line-number="142">  <span class="dt">title.text =</span> <span class="st">"Exploring models with different glm families"</span></a>
<a class="sourceLine" id="cb8-143" data-line-number="143">)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glm2-1.png" width="960"></p>
</div>
<div id="generalized-linear-mixed-effects-model-glmer" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-effects-model-glmer" class="anchor"></a>generalized linear mixed-effects model (<code>glmer</code>)</h2>
<p>In the previous example, we saw how being a female and being a child was predictive of surviving the Titanic disaster. But in that analysis, we didn’t take into account one important factor: the passenger class in which people were traveling. Naively, we have reasons to believe that the effects of sex and age might be dependent on the class (maybe rescuing passengers in the first class were given priority?). To take into account this hierarchical structure of the data, we can run generalized linear mixed effects model with a random slope for class.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">x =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/glmer">glmer</a></span>(</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>(Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">|</span><span class="st"> </span>Class),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="co"># select half of the sample to reduce the time of execution</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>Titanic_full, <span class="dt">size =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lme4/topics/lmerControl">glmerControl</a></span>(</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">      <span class="dt">optimizer =</span> <span class="st">"Nelder_Mead"</span>,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">      <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">      <span class="dt">boundary.tol =</span> <span class="fl">1e-7</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    )</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  ),</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmer-1.png" width="576"></p>
<p>As we had expected, once we take into account the differential relationship that might exist between survival and predictors across different passenger classes, only the sex factor remain a significant predictor (also see the <a href="https://indrajeetpatil.github.io/ggstatsplot/articles/ggpiestats.html"><code>ggspiestats</code></a> vignette where we had explored this dataset). In other words, being a female was the strongest predictor of whether someone survived the tragedy that befell the Titanic.</p>
</div>
<div id="cumulative-link-models-clm" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-link-models-clm" class="anchor"></a>Cumulative Link Models (<code>clm</code>)</h2>
<p>So far we have dealt either with continuous or nominal/factor responses (or output variables), but sometimes we will encounter <strong>ordinal</strong> data (e.g., Likert scale measurement in behavioral sciences). In these cases, ordinal regression models are more suitable. To study these models, we will use <code>intent_morality</code> dataset included in the <code>ggstatsplot</code> package. This dataset contains moral judgments (“how wrong was this behavior?”, “how much punishment does the agent deserve?”; on a Likert scale of 1-7) by participants about third-party actors who harmed someone. There are four different conditions formed out of belief (neutral, negative) and outcome (neutral, negative) for four different vignettes, each featuring a different type of harm. The question we are interested in is what explains variation in participants’ rating: information about intentionality, consequences, or their interaction?</p>
<p>We will carry out this analysis for each type of harm because we might expect that people might rely on intent information for some types of harm, but not others (e.g., take into account intent information for minor harms, like bumping into someone, but not for more serious harms, like burning someone’s hand)-</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co"># running the function for each type of harm and creating a list of plots</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># to speed up calculations, we will use just half of the dataset</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">plotlist &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>intent_morality, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.data =</span> ., <span class="dt">plot.title =</span> harm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">  </span>base<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/base/topics/split">split</a></span>(<span class="dt">x =</span> ., <span class="dt">f =</span> .<span class="op">$</span>harm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">    <span class="dt">.x =</span> .,</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">    <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">      <span class="dt">x =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clm">clm</a></span>(</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">        <span class="dt">formula =</span> <span class="kw">as.factor</span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome,</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">        <span class="dt">link =</span> <span class="st">"logit"</span>,</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">        <span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">        <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clm.control">clm.control</a></span>(</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">          <span class="dt">maxIter =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">          <span class="dt">convergence =</span> <span class="st">"silent"</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20">        ),</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">      ),</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">      <span class="dt">title =</span> glue<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/glue/topics/glue">glue</a></span>(<span class="st">"Type of harm: {.$plot.title}"</span>),</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">      <span class="dt">caption.summary =</span> <span class="ot">FALSE</span>                            <span class="co"># suppress model diagnostics</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">      </span><span class="co">#ggplot2::scale_y_discrete(labels = c("belief (neutral)", "interaction", "outcome (neutral)")) +</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="st">      </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"logit regression coefficient"</span>,</a>
<a class="sourceLine" id="cb10-27" data-line-number="27">                    <span class="dt">y =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb10-28" data-line-number="28">  )</a>
<a class="sourceLine" id="cb10-29" data-line-number="29"></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co"># combining the plots</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(<span class="dt">plotlist =</span> plotlist)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clm-1.png" width="1152"></p>
<p>As can be seen from this plot, across all four types of harm, the actors who had malicious intent are judged to be worse than actors who had neutral intent, and actors who cause harm are judged to more harshly than actors who don’t. But how intent and outcome information interact with each other depends on the type of harm.</p>
</div>
<div id="cumulative-link-mixed-models-clmm" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-link-mixed-models-clmm" class="anchor"></a>Cumulative Link Mixed Models (<code>clmm</code>)</h2>
<p>In the previous analysis, we carried four separate ordinal regression models to see the generalizability (across items) of effects intent and outcome information on moral judgments. But a better of accounting for such item level differences is to model them as random factors. So, in the current section, we used ordinal mixed-effects regression model to see how belief and outcome contribute towards variation in moral judgment ratings-</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">x =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clmm">clmm</a></span>(</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="dt">formula =</span> <span class="kw">as.factor</span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>(belief <span class="op">+</span><span class="st"> </span>outcome <span class="op">|</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">                                                        </span>harm),</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="co"># to speed up calculations, we will use just half of the dataset</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="dt">.data =</span> ggstatsplot<span class="op">::</span>intent_morality, id <span class="op">&lt;=</span><span class="st"> </span><span class="dv">250</span>),</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clmm.control">clmm.control</a></span>(</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">      <span class="dt">method =</span> <span class="st">"nlminb"</span>,</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">      <span class="dt">maxIter =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">      <span class="dt">gradTol =</span> <span class="fl">1e-4</span>,</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">      <span class="dt">innerCtrl =</span> <span class="st">"noWarn"</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14">    )</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  ),</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  <span class="co"># suppress model diagnostics</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  <span class="dt">caption.summary =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">  </span><span class="co">#ggplot2::scale_y_discrete(labels = c("belief (neutral)", "interaction", "outcome (neutral)")) +</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"coefficient from ordinal mixed-effects regression"</span>,</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">                <span class="dt">y =</span> <span class="st">"fixed effects"</span>)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clmm-1.png" width="576"></p>
<p>As we had premeditated from the item-level analysis, mixed effects regression didn’t reveal any interaction effect. That is, most of the variance was accounted for by the information about whether there was harmful intent and whether there was harm, at least this is the effect we found with these four types of (minor) harms.</p>
<p>Note that, by default, <code>beta</code> parameters are shown for <code>clm</code> and <code>clmm</code> models, but you can also plot either just <code>alpha</code> or <code>both</code> using <code>ggcoefstats</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># to speed up calculations, we will use just half of the dataset</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  <span class="dt">x =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clmm">clmm</a></span>(</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    <span class="dt">formula =</span> <span class="kw">as.factor</span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>(belief <span class="op">+</span><span class="st"> </span>outcome <span class="op">|</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">                                                        </span>harm),</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">    <span class="dt">link =</span> <span class="st">"logit"</span>,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>intent_morality, <span class="dt">size =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">    <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ordinal/topics/clmm.control">clmm.control</a></span>(</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">      <span class="dt">maxIter =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">      <span class="dt">gradTol =</span> <span class="fl">1e-4</span>,</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">      <span class="dt">innerCtrl =</span> <span class="st">"noWarn"</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">    )</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">  ),</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  <span class="dt">coefficient.type =</span> <span class="st">"alpha"</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"logit regression coefficients"</span>,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">                <span class="dt">y =</span> <span class="st">"threshold parameters"</span>)</a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clmm1-1.png" width="576"></p>
</div>
<div id="repeated-measures-anova-aovlist" class="section level2">
<h2 class="hasAnchor">
<a href="#repeated-measures-anova-aovlist" class="anchor"></a>Repeated measures ANOVA (<code>aovlist</code>)</h2>
<p>Let’s now consider an example of a repeated measures design where we want to run omnibus ANOVA with a specific error structure. To carry out this analysis, we will first have to convert the iris dataset from wide to long format such that there is one column corresponding to <code>attribute</code> (which part of the calyx of a flower is being measured: <code>sepal</code> or <code>petal</code>?) and one column corresponding to <code>measure</code> used (<code>length</code> or <code>width</code>?). Note that this is within-subjects design since the same flower has both measures for both attributes. The question we are interested in is how much of the variance in measurements is explained by both of these factors and their interaction.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(ggstatsplot)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># for reproducibility</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co"># having a look at iris before converting to long format</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(iris)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; Observations: 150</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; $ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9,...</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; $ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1,...</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; $ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5,...</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; $ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1,...</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; $ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, s...</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co"># converting the iris dataset to long format</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">iris_long &lt;-<span class="st"> </span>datasets<span class="op">::</span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.data =</span> ., <span class="dt">id =</span> dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>(<span class="dt">x =</span> Species)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">    <span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">    <span class="dt">key =</span> <span class="st">"condition"</span>,</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">    <span class="dt">value =</span> <span class="st">"value"</span>,</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">    Sepal.Length<span class="op">:</span>Petal.Width,</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">    <span class="dt">convert =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">    <span class="dt">factor_key =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/separate">separate</a></span>(</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">    <span class="dt">col =</span> <span class="st">"condition"</span>,</a>
<a class="sourceLine" id="cb13-30" data-line-number="30">    <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">"attribute"</span>, <span class="st">"measure"</span>),</a>
<a class="sourceLine" id="cb13-31" data-line-number="31">    <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\\</span><span class="st">."</span>,</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">    <span class="dt">convert =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(<span class="dt">x =</span> .)</a>
<a class="sourceLine" id="cb13-35" data-line-number="35"></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="co"># looking at the long format data</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="dt">x =</span> iris_long)</a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="co">#&gt; Observations: 600</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"><span class="co">#&gt; $ Species   &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, seto...</span></a>
<a class="sourceLine" id="cb13-41" data-line-number="41"><span class="co">#&gt; $ id        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1...</span></a>
<a class="sourceLine" id="cb13-42" data-line-number="42"><span class="co">#&gt; $ attribute &lt;chr&gt; "Sepal", "Sepal", "Sepal", "Sepal", "Sepal", "Sepal"...</span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43"><span class="co">#&gt; $ measure   &lt;chr&gt; "Length", "Length", "Length", "Length", "Length", "L...</span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44"><span class="co">#&gt; $ value     &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5....</span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"></a>
<a class="sourceLine" id="cb13-46" data-line-number="46"><span class="co"># specifying the model (note the error structure)</span></a>
<a class="sourceLine" id="cb13-47" data-line-number="47">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb13-48" data-line-number="48">  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span>attribute <span class="op">*</span><span class="st"> </span>measure <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(id <span class="op">/</span><span class="st"> </span>(attribute <span class="op">*</span><span class="st"> </span>measure)),</a>
<a class="sourceLine" id="cb13-49" data-line-number="49">             <span class="dt">data =</span> iris_long),</a>
<a class="sourceLine" id="cb13-50" data-line-number="50">  <span class="dt">effsize =</span> <span class="st">"omega"</span>,</a>
<a class="sourceLine" id="cb13-51" data-line-number="51">  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggthemes/topics/theme_fivethirtyeight">theme_fivethirtyeight</a></span>(),</a>
<a class="sourceLine" id="cb13-52" data-line-number="52">  <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-53" data-line-number="53">  <span class="dt">stats.label.color =</span> <span class="kw">c</span>(<span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"darkgreen"</span>),</a>
<a class="sourceLine" id="cb13-54" data-line-number="54">  <span class="dt">title =</span> <span class="st">"Variation in measurements for Iris species"</span>,</a>
<a class="sourceLine" id="cb13-55" data-line-number="55">  <span class="dt">subtitle =</span> <span class="st">"Source: Iris data set (by Fisher or Anderson)"</span></a>
<a class="sourceLine" id="cb13-56" data-line-number="56">) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-57" data-line-number="57"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">caption =</span> <span class="st">"Results from 2 by 2 RM ANOVA"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-58" data-line-number="58"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">face =</span> <span class="st">"plain"</span>))</a>
<a class="sourceLine" id="cb13-59" data-line-number="59"><span class="co">#&gt; Note: No model diagnostics information available for the object of class aovlist . Future release might support this.</span></a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aovlist-1.png" width="768"></p>
<p>As revealed by this analysis, all effects of this model are significant. But most of the variance is explained by the <code>attribute</code>, with the next important explanatory factor being the <code>measure</code> used. A very little amount of variation in measurement is accounted for by the interaction between these two factors.</p>
</div>
<div id="robust-regression-lmrob-glmrob" class="section level2">
<h2 class="hasAnchor">
<a href="#robust-regression-lmrob-glmrob" class="anchor"></a>Robust regression (<code>lmRob</code>, <code>glmRob</code>)</h2>
<p>The robust regression models, as implemented in robust package are also supported. But since no 95% CI are available in this case, only the dots will be shown.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">    <span class="dt">x =</span> robust<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/robust/topics/glmRob">glmRob</a></span>(</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">      <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">      <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/stats/topics/family">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    ),</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">    <span class="dt">title =</span> <span class="st">"generalized robust linear model"</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">  ),</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    <span class="dt">x =</span> robust<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/robust/topics/lmRob">lmRob</a></span>(<span class="dt">formula =</span> Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">*</span><span class="st"> </span>Species, <span class="dt">data =</span> iris),</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">    <span class="dt">title =</span> <span class="st">"robust linear model"</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  ),</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>),</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">  <span class="dt">title.text =</span> <span class="st">"Robust variants of lm and glm"</span>,</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">  <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">  <span class="dt">ncol =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18">)</a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; Note: No 95% confidence intervals available for regression coefficients from glmRob object, so skipping whiskers in the plot.Note: No 95% confidence intervals available for regression coefficients from lmRob object, so skipping whiskers in the plot.</span></a></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/robust-1.png" width="768"></p>
</div>
<div id="and-much-more" class="section level2">
<h2 class="hasAnchor">
<a href="#and-much-more" class="anchor"></a>And much more…</h2>
<p>This vignette was supposed to give just a taste for only <em>some</em> of the regression models supported by <code>ggcoefstats</code>. The full list of supported models will keep expanding as additional tidiers are added to the <code>broom</code> package: <a href="https://broom.tidyverse.org/articles/available-methods.html" class="uri">https://broom.tidyverse.org/articles/available-methods.html</a></p>
<p>Note that not <strong>all</strong> models supported by <code>broom</code> will be supported by <code>ggcoefstats</code>. In particular, classes of objects for which there is no estimates present (e.g., <code>kmeans</code>) are not supported.</p>
</div>
<div id="suggestions" class="section level2">
<h2 class="hasAnchor">
<a href="#suggestions" class="anchor"></a>Suggestions</h2>
<p>If you find any bugs or have any suggestions/remarks, please file an issue on GitHub: <a href="https://github.com/IndrajeetPatil/ggstatsplot/issues" class="uri">https://github.com/IndrajeetPatil/ggstatsplot/issues</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#general-structure-of-the-plots">General structure of the plots</a></li>
      <li><a href="#omnibus-anova-aov">omnibus ANOVA (<code>aov</code>)</a></li>
      <li><a href="#linear-model-lm">linear model (<code>lm</code>)</a></li>
      <li><a href="#linear-mixed-effects-model-lmer">linear mixed-effects model (<code>lmer</code>)</a></li>
      <li><a href="#non-linear-least-squares-model-nls">Non-linear least-squares model (<code>nls</code>)</a></li>
      <li><a href="#generalized-linear-model-glm">generalized linear model (<code>glm</code>)</a></li>
      <li><a href="#generalized-linear-mixed-effects-model-glmer">generalized linear mixed-effects model (<code>glmer</code>)</a></li>
      <li><a href="#cumulative-link-models-clm">Cumulative Link Models (<code>clm</code>)</a></li>
      <li><a href="#cumulative-link-mixed-models-clmm">Cumulative Link Mixed Models (<code>clmm</code>)</a></li>
      <li><a href="#repeated-measures-anova-aovlist">Repeated measures ANOVA (<code>aovlist</code>)</a></li>
      <li><a href="#robust-regression-lmrob-glmrob">Robust regression (<code>lmRob</code>, <code>glmRob</code>)</a></li>
      <li><a href="#and-much-more">And much more…</a></li>
      <li><a href="#suggestions">Suggestions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/indrajeetspatilmorality/">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: '44345fbe359c5496fbc3955c513333d1',
    indexName: 'ggstatsplot',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
